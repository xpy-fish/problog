<!DOCTYPE html>
<html lang="en">
<head>
<base href="#(basepath)">
    <meta charset="UTF-8">
    <title>WHUT博客</title>
<!--     <link href="http://cdn.bootcss.com/bootstrap/3.3.7/css/bootstrap.min.css"  rel="stylesheet"> -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" type="text/css"  href="asset/css/message.css" >
    <link rel="stylesheet" type="text/css"  href="asset/css/webHeadNav.css" >
</head>
<body>
<!-- 主页面导航条 -->
		<div class="person_nav">
			<nav class="navbar navbar-default">
			  <div class="container-fluid">
			    <!-- Brand and toggle get grouped for better mobile display -->
			    <div class="navbar-header">
			      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
			        <span class="sr-only">Toggle navigation</span>
			        <span class="icon-bar"></span>
			        <span class="icon-bar"></span>
			        <span class="icon-bar"></span>
			      </button>
			      <a class="navbar-brand blog_person_logo" style="height:60px;color:#337ab7" href="#">启程·博客</a>
			    </div>
			
			    <!-- Collect the nav links, forms, and other content for toggling -->
			    <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
			      <ul class="nav navbar-nav">
			        <li><a href="website/homePage">首页</a></li>
			        <li><a href="website/column">专栏</a></li>
			        <li><a href="website/message">消息</a></li>
			        <li><a href="#">下载app</a></li>      
			      </ul>
			      <form id="searchForm" class="navbar-form navbar-left" action="website/search" method="post" target="_blank">
			        <div class="input-group">
			        	<input type="hidden" name="homeSearch" value="true"/>
			            <input type="text" name="searchContent" class="form-control" placeholder="Search">
				        <span class="input-group-btn">
					        <button onclick="doFormSubmit()" class="btn btn-default">
					        	<span class="glyphicon glyphicon-search"></span>
					        </button>
					    </span>
				    </div>
			      </form>
			      <!--没有登录的情况-->
			      <ul class="nav navbar-nav navbar-right" id="logstate">
			          <li><a class="blog_head_nav_login" id="sign_in" href="website/login">登录</a></li>
		              <li><a class="blog_head_nav_signup" style="color:red" id="sign_up" href="website/register">注册</a></li>
			          <li class="dropdown" id = "loginfo">
		                 <a href="#" class="dropdown-toggle" style="margin-top:-12px;margin-bottom:-12px" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false"><img id="logicon" class="img-circle blog_head_icon" src="asset/img/boke.jpg" alt="头像"/> <span class="caret"></span></a>
		                 <ul class="dropdown-menu">
				            <li><a href="website/user">我的主页</a></li>
				            <li><a href="#">个人信息</a></li>
				            <li><a href="#">喜欢的文章</a></li>
				            <li role="separator" class="divider"></li>
				            <li><a href="website/homePage/logout">退出登录</a></li>
		                </ul>
		             </li> 
						 <li class="blog_head_nav_a"><a class="blog_head_nav_write"  target="_blank" href="website/article">
						     <span class="glyphicon glyphicon-pencil"></span>写博客
						     </a>
						 </li>
			     </ul>
			  </div>
		</div>
	</nav>
</div>
<div class="container" style="margin-top: 100px;">

<!------------------------------------------左边ul栏-------------------------------------->
    <div class="col-lg-4">
        <ul class="blist" >
        
            
           	<a href="javascript:clickComment()" style="text-decoration: none;">
                <li class="active" onclick="activeEvent(this)">
                	<i class="glyphicon glyphicon-comment"></i>
                	<span style="">评论</span>
 				</li>               
            </a>
           
            
                <a href="javascript:clickFan()" style="text-decoration: none;">
                	<li onclick="activeEvent(this)">
                    	<i class="glyphicon glyphicon-heart"></i>
                    	<span >喜欢和赞</span>
                    </li>
                </a>
            
             <a href="javascript:clickCollect()" style="text-decoration: none;">
            	<li onclick="activeEvent(this)">
                    <i class="glyphicon glyphicon-user"></i>
                    <span>关注</span>
            	</li>
            </a>
            
        
            <a href="" style="text-decoration: none;">
           		<li onclick="activeEvent(this)">
                	<i class="glyphicon glyphicon-magnet"></i>
                	<span>联系我们</span>
       		 	</li>
         	</a>
            
           
         <a href="#" style="text-decoration: none;">
            	<li onclick="activeEvent(this)">
                	<i class="glyphicon glyphicon-option-horizontal"></i>
               		<span>其它提醒</span>
        		</li>
        </a>
        </ul>
    </div>
    <!------------------------------------------右边显示栏-------------------------------------->
    <div class="col-lg-8" id="right_content">  
    </div>
</div>
</body>
<!-- <script src="https://cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script> -->
<!-- <script src="https://cdn.bootcss.com/bootstrap/3.3.7/js/bootstrap.min.js"></script> -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script>
<script>
    function activeEvent(e){
        $("li").removeClass("active");
        $(e).addClass("active");
    }
    function useractiveEvent(e){
        $("li").removeClass("user-active");
        $(e).addClass("user-active");
    }
    function createHeaderComment(){
		var ht = '<div class="header_comment"><a href="javascript:clickComment()" style="font-size: 15px;font-weight: bold;cursor: pointer;text-decoration: none;color: #555555;margin-right:10px;">收到的评论</a>'+
		'<a href="javascript:clickSendComment()" style="font-size: 15px;font-weight: bold;cursor: pointer;text-decoration: none;color: #555555">发出的评论</a></div>'+
		'<ul id="comment_content"class="comment-list" style="padding-left:0px"></ul>';
		$("#right_content").prepend(ht);
    }
    function createLiComment(i){
        var ht =
            		'<li style="border-top:dotted 1px #f0f0f0;height: 88px">'+
                    ' <div class="pull-right"><span id="thetime'+i+'"></span>'+
             		'<a   data-toggle="dropdown"href="javascript:menuShow();"><i class="glyphicon glyphicon-menu-down"></i></a>'+
             		'<ul  class="dropdown-menu" style="top:auto;">'+
                 	'<li><a id="delete_content'+i+'"><i class="glyphicon glyphicon-trash">删除评论</i></a></li>'+
                 	'<li><a id="ignore_user'+i+'"><i class="glyphicon glyphicon-eye-close">屏蔽用户</i></a></li>'+
                 	'<li><a id="flag_user'+i+'"><i class="glyphicon glyphicon-flag">举报用户</i></a></li></ul>'+
        			'</div><a style="float: left">'+
            		'<img id="theicon'+i+'"alt="图片" style=" border-radius:50%;width: 48px;height: 48px;margin: 20px 10px 20px 20px">'+
         			'</a><div style="float:left;display: inline-block;margin: 20px 0px 20px 0px;height: 48px">'+
             		'<a id="thename'+i+'"style="cursor: pointer;color: #333;text-decoration: none;font-size: 15px"></a>'+
            		'<br><p id="thecontent'+i+'"style="display: inline-block;"></p><span id="thetitle'+i+'" style="float:right;"></span></div></li>';
					$("#comment_content").append(ht);
    }
    function createHeaderFan(){
		var ht = '<div style="height: 52px"><ul class="nav navbar-nav">'+
        			  '<li class="user-active" onclick="useractiveEvent(this)"><a href="javascript:clickFaned()">有缘关注</a></li>'+
                      '<li class="" onclick="useractiveEvent(this)"><a href="javascript:clickFaning()"><i class="glyphicon glyphicon-user"></i>随缘推荐</a>'+
        			  '</li></ul></div><div ><ul id="fan_content"style="width: 100%;padding-left: 0px;list-style: none;"></ul></div>';
		$("#right_content").prepend(ht);
    }
    function createLiFan(i){
		var ht = 
        			  '<li style="border-top:dotted 1px #f0f0f0;height: 88px;width: 100%;">'+
                      '<button class="glyphicon glyphicon-plus" style="margin-top:25px;width:100px;height: 38px;float:right;border:none;background-color: #4CAF50;font-size:18px;border-radius: 30px;color:white;">关注</button>'+
                      '<a style="float: left"><img alt="图片" style=" border-radius:50%;width: 48px;height: 48px;margin: 20px 10px 20px 20px"></a>'+
                      '<div style="float:left;display: inline-block;margin: 20px 0px 20px 0px;height: 48px">'+
                      '<a style="cursor: pointer;color: #333;text-decoration: none;font-size: 15px">昵称</a><br>'+
                      '<p style="display: inline-block;">发布的文章</p></div></li>';
        $("#fan_content").append(ht);
    }
    function createHeaderCollect(){
		var ht = '<div style="padding: 20px 250px 20px 250px;text-align: center;border-bottom: solid 1px #f0f0f0;">'+
        			  '<i class="glyphicon glyphicon-bookmark" style="font-size: 40px;color:#ea6f5a;"></i>'+
                      '<span style="font-size: 30px;margin-bottom: 5px">吾之喜好</span></div><div><ul id="collect_content" style="list-style: none;padding-left: 0"></ul></div>';
    	$("#right_content").prepend(ht);
    }
    function createLiCollect(i){
    	var ht = 
            		  '<li><a href="#"><img id="theimg'+i+'" style="width:140px;height: 100px;float: right;top: 5px;margin: 30px 10px 30px 10px;border-radius: 10px"></a>'+
            		  '<div style="padding:30px 160px 30px 0;height: 160px;border-bottom: solid 1px #f0f0f0">'+
                      '<a style="font-size: 18px;font-weight: 700;line-height: 1.5;" id="thetitle'+i+'"></a>'+
                      '<p style="margin: 0 0 8px;font-size: 15px;line-height: 24px;color: #999;" id="thecontent'+i+'"></p>'+
                      '<div><span style="color: #999" id="theauthor'+i+'"></span>'+
                      '<div  style="display:inline-block;"><button class="glyphicon glyphicon-comment" style="border:none;background:white;color:#999;dispaly:inline-block;" ><span id="commentN'+i+'" style="margin-left:5px;"></span></button></div>'+
                      '<div  style="display:inline-block;"><button class="glyphicon glyphicon-eye-open" style="border:none;background:white;color:#999;" ><span id="clickN'+i+'"style="margin-left:5px;"></span></button></div>'+
                      '</div></div></li>';
        $("#collect_content").append(ht);
    }
    function clickComment(){
    	$("#right_content").html("");
    	createHeaderComment();
    	$.ajax({
			type:"post",
			datatype:"json",
			url:"website/message/getGetCommentJson",
			data:{"userID":#(userID??)},
			success:function(data){
				console.log(data);
				for(i=0;i<data.jsonLen;i++){
					createLiComment(i);
					$("#thetime"+i).text(data.getCommentData[i].comt);
					$("#theicon"+i).attr("src",data.getCommentData[i].icon);
					$("#thename"+i).text(data.getCommentData[i].comp);
					$("#thecontent"+i).text(data.getCommentData[i].comc);
					$("#thetitle"+i).text("    ——来自《"+data.getCommentData[i].title+"》");
				}
			}
        });
    }
    function clickSendComment(){
    	$("#right_content").html("");
    	createHeaderComment();
    	$.ajax({
			type:"post",
			datatype:"json",
			url:"website/message/getSendCommentJson",
			data:{"userID":#(userID??)},
			success:function(data){
				console.log(data);
				for(i=0;i<data.jsonLen;i++){
					createLiComment(i);
					$("#thetime"+i).text(data.sendCommentData[i].comt);
					$("#theicon"+i).attr("src",data.icon);
					$("#thename"+i).text("评文章：《"+data.sendCommentData[i].comp+"》");
					$("#thecontent"+i).text("评语："+data.sendCommentData[i].comc);
					$("#ignore_user"+i).hide();
					$("#flag_user"+i).hide();
				}
			}
        });
    }
    function clickFan(){
    	$("#right_content").html("");
    	createHeaderFan();
		for(i=0;i<5;i++){
			createLiFan(i);
		}
    }
    function clickCollect(){
    	$("#right_content").html("");
    	createHeaderCollect();
    	$.ajax({
			type:"post",
			datatype:"json",
			url:"website/message/getCollectJson",
			data:{"userID":#(userID??)},
			success:function(data){
				console.log(data);
				for(i=0;i<data.jsonLen;i++){
					createLiCollect(i);
					$("#theimg"+i).attr("src",data.getCollectData[i].c_url_img);
					$("#thetitle"+i).text(data.getCollectData[i].title);
					$("#thecontent"+i).text(data.getCollectData[i].s_content);
					$("#theauthor"+i).text(data.getCollectData[i].author);
					if(data.getCollectData[i].comN){
						$("#commentN"+i).text(data.getCollectData[i].comN);
					}else{
						$("#commentN"+i).text(0);
					}
					if(data.getCollectData[i].clickN){
						$("#clickN"+i).text(data.getCollectData[i].clickN);
					}else{
						$("#clickN"+i).text(0);
					}
				}
			}
        });
    }
    function clickFaned(){
    	$("#fan_content").html("");
    	for(i=0;i<2;i++){
			createLiFan(i);
		}
    }
    function clickFaning(){
    	$("#fan_content").html("");
    	for(i=0;i<7;i++){
			createLiFan(i);
		}
    }
    $(document).ready(function(){
    	if(#(state??)){
    		$("#sign_in").hide();
    		$("#sign_up").hide(); 
    		document.getElementById("logicon").src = "#(icon??)"; 
    	}else{
    		$("#loginfo").hide();
    	}
    	$("#right_content").html("");
    	createHeaderComment();
    	clickComment();
    });
    function doFormSubmit(){
    	var str = $("input[name='searchContent']").val();
    	if(str.replace(/\s+/g,"")==null){
    		alert("请输入内容");
    	}else{
    		$("#searchForm").submit();
    	}	
    }
</script>
</html>